---
title: "Lagrangian Coherent Structures"
execute:
  echo: false
  cache: true
format:
    revealjs:
        center: true
        theme: [default]
        html-math-method: mathjax
        slide-number: c/t
bibliography: lcs.bib
# csl: chicago-author-date.csl
---

```{julia}
using CairoMakie
using LaTeXStrings

include("load_interpolate_netcdf.jl")

DATA = "data/cmems_aus.nc"
lat, lon, days, u, v, land = read_nc_vel(DATA);

glon = repeat(lon, outer=(1, length(lat)))';
glat = repeat(lat, outer=(1, length(lon)));

# Generate speed animation and save
include("eulerian_visualisation.jl")
eulerian_animation(glon, glat, days[1:365], u, v, "figures/eulerian_speed.mp4"; colormap=:jet, nan_color=RGBAf(0, 0, 0, 1));
```

## {background-video="figures/perpetual_ocean.mp4" background-video-muted="true"}

##

If video breaks:

[https://www.youtube.com/watch?v=CCmTY0PKGDs]()

<!-- ## {.smaller}

<p align="center">
  ![](figures/haller_lcs.png)
</p> -->
<!-- Figure 1 of @Haller_2015_LagrangianCoherentStructures. -->

##

LCSs tell us about:

:::{.incremental}
- Where things end up

- Pollutant spread

- Temperature transport

- How jellyfish swim
:::

##

The velocity at a point $x \in \Omega_0$ and time $t \in [0,T]$ is given by the **Eulerian** velocity
$$
u(x,t)
$$

##
{{< figures/eulerian_speed.mp4 >}}


##
The **Lagrangian** trajectories $X(t)$ solve
$$
\frac{\mathrm{d}X}{\mathrm{d}t} = u\left(X, t\right), \quad X(0) = x
$$

##
Define the **flow map** $F_0^t(x)$ as

$$
\frac{\partial F_0^t(x)}{\partial t} = u\left(F_0^t(x), t\right), \quad F_0^0(x) = x
$$

##

OCEAN TRAJECTORY EXAMPLES HERE

##

A **Lagrangian coherent structure (LCS)** is a spatial region that remains coherent under the flow.

. . .

LCSs are often computed from the flow map $F_0^t(x)$.

##
:::{.incremental}
1. Finite-time Lyapunov exponent (FTLE)

2. Lagrangian-averaged vorticity deviation (LAVD)

3. Stochastic sensitivity ($S^2$)
:::

## 1. Finite-time Lyapunov exponent

. . .

$$
\mathrm{FTLE}\left(x,t\right) = \frac{1}{t}\ln{\left|\!\left|\nabla F_0^t(x)\right|\!\right|}.
$$

. . .

Measures **stretching**.

## 1. Finite-time Lyapunov exponent

OCEAN FTLE FIELD HERE

## 1. Finite-time Lyapunov exponent

OCEAN FTLE STRUCTURES HERE

## 2. Lagrangian-averaged vorticity deviation

. . .

$$
\mathrm{LAVD}\left(x,t\right) = \int_0^t{\left|\omega\left(F_0^t(x), \xi\right) - \bar{\omega}\left(\xi\right)\right|\mathrm{d}\xi},
$$
where $\omega = \nabla \times u$ and
$$
\bar{\omega}(\xi) = \frac{1}{\left|\Omega_0\right|}\int_{\Omega_0}{\omega\left(F_0^\xi(z), \xi\right)\mathrm{d}z}.
$$

. . .

Measures **rotation**.

## 2. Lagrangian-averaged vorticity deviation

OCEAN LAVD FIELD HERE

## 2. Lagrangian-averaged vorticity deviation

OCEAN LAVD STRUCTURES HERE

## 3. Stochastic sensitivity

. . .

$$
S^2\left(x,t\right) = \left|\!\left|\int_0^t{L\left(x,t,\tau\right)L\left(x,t,\tau\right)^T\mathrm{d}\tau}\right|\!\right|,
$$
where
$$
L\left(x,t,\tau\right) \coloneqq \nabla F_0^t(x)\left[\nabla F_0^\tau(x)\right]^{-1}.
$$

. . .

Measures **spatial uncertainty**.


## 3. Stochastic sensitivity

OCEAN $S^2$ FIELD HERE


## 3. Stochastic sensitivity

OCEAN $S^2$ STRUCTURES HERE

##

ALL THREE HERE?

